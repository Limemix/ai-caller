# ğŸ• Ğ¢ĞµÑÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¾Ğ³Ğ¾ Ñ‡Ğ°ÑÑƒ

## Ğ¯Ğº Ñ†Ğµ Ğ¿Ñ€Ğ°Ñ†ÑÑ”

### 1ï¸âƒ£ **Ğ Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ: 8:00 - 22:00 (ĞšĞ¸Ñ—Ğ²)**

```typescript
// Ğ›Ğ¾Ğ³Ñ–ĞºĞ° Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ¸:
const hours = kyivTime.getHours();
return hours >= 8 && hours < 22;
```

### 2ï¸âƒ£ **USE_MOCK_CALLS=true â†’ Ğ†Ğ³Ğ½Ğ¾Ñ€ÑƒÑ” Ñ‡Ğ°Ñ**
- Ğ”Ğ·Ğ²Ñ–Ğ½ĞºĞ¸ Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ **Ğ·Ğ°Ğ²Ğ¶Ğ´Ğ¸**
- Ğ”Ğ»Ñ Ñ‚ĞµÑÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ñ‚Ğ° Ñ€Ğ¾Ğ·Ñ€Ğ¾Ğ±ĞºĞ¸

### 3ï¸âƒ£ **USE_MOCK_CALLS=false â†’ ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ÑÑ” Ñ‡Ğ°Ñ**
- Ğ”Ğ·Ğ²Ñ–Ğ½ĞºĞ¸ Ğ² Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ â†’ Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ Ğ·Ñ€Ğ°Ğ·Ñƒ
- Ğ”Ğ·Ğ²Ñ–Ğ½ĞºĞ¸ Ğ¿Ñ–ÑĞ»Ñ 22:00 â†’ Ğ²Ñ–Ğ´ĞºĞ»Ğ°Ğ´Ğ°ÑÑ‚ÑŒÑÑ Ğ´Ğ¾ 8:00 Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ½Ñ
- Ğ”Ğ·Ğ²Ñ–Ğ½ĞºĞ¸ Ğ´Ğ¾ 8:00 â†’ Ğ²Ñ–Ğ´ĞºĞ»Ğ°Ğ´Ğ°ÑÑ‚ÑŒÑÑ Ğ´Ğ¾ 8:00 ÑÑŒĞ¾Ğ³Ğ¾Ğ´Ğ½Ñ–

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸

### Ğ¢ĞµÑÑ‚ 1: ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ñ‡Ğ°ÑÑƒ
```bash
node test-working-hours.js
```

**Ğ©Ğ¾ Ñ€Ğ¾Ğ±Ğ¸Ñ‚ÑŒ:**
- ĞŸĞ¾ĞºĞ°Ğ·ÑƒÑ” Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ¸Ğ¹ Ñ‡Ğ°Ñ (ĞšĞ¸Ñ—Ğ²)
- ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ÑÑ” Ñ‡Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ· Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ
- Ğ’Ñ–Ğ´Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ” 3 Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ– Ğ´Ğ·Ğ²Ñ–Ğ½ĞºĞ¸
- ĞŸĞ¾ĞºĞ°Ğ·ÑƒÑ” Ñ‰Ğ¾ Ğ¼Ğ°Ñ” Ğ²Ñ–Ğ´Ğ±ÑƒÑ‚Ğ¸ÑÑ

### Ğ¢ĞµÑÑ‚ 2: Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ñ–Ñ Ğ¿Ñ–ÑĞ»Ñ Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¾Ğ³Ğ¾ Ñ‡Ğ°ÑÑƒ
```bash
node test-after-hours.js
```

**Ğ©Ğ¾ Ñ€Ğ¾Ğ±Ğ¸Ñ‚ÑŒ:**
- Ğ†Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ñ–Ñ— ÑĞº Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ²Ñ–Ğ´ĞºĞ»Ğ°Ğ´ĞµĞ½Ñ– Ğ´Ğ·Ğ²Ñ–Ğ½ĞºĞ¸
- Ğ’Ñ–Ğ´Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ” 5 Ğ´Ğ·Ğ²Ñ–Ğ½ĞºÑ–Ğ² Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ñƒ

### Ğ¢ĞµÑÑ‚ 3: Ğ¡Ñ‚Ñ€ĞµÑ-Ñ‚ĞµÑÑ‚ (1000 Ğ´Ğ·Ğ²Ñ–Ğ½ĞºÑ–Ğ²)
```bash
node stress-test.js
```

**Ğ©Ğ¾ Ñ€Ğ¾Ğ±Ğ¸Ñ‚ÑŒ:**
- Ğ’Ñ–Ğ´Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ” 1000 Ğ´Ğ·Ğ²Ñ–Ğ½ĞºÑ–Ğ²
- Ğ— USE_MOCK_CALLS=true - Ğ²ÑÑ– Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ
- Ğ— USE_MOCK_CALLS=false - Ğ²Ñ€Ğ°Ñ…Ğ¾Ğ²ÑƒÑ” Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ

## ğŸ“Š Ğ©Ğ¾ Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€ÑÑ‚Ğ¸ Ğ² Bull Board

**Ğ Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ (8:00-22:00):**
- âœ… Active: 3 (Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ)
- âœ… Waiting: N (Ñ‡ĞµĞºĞ°ÑÑ‚ÑŒ)
- âœ… Delayed: 0

**ĞĞ• Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ:**
- âœ… Delayed: N (Ğ²Ñ–Ğ´ĞºĞ»Ğ°Ğ´ĞµĞ½Ñ– Ğ´Ğ¾ 8:00)
- âœ… Active: 0
- âœ… Waiting: 0

## ğŸ”§ ĞĞ°Ğ»Ğ°ÑˆÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ

### Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ:
```env
# .env
WORKING_HOURS_START=8   # ĞŸĞ¾Ñ‡Ğ°Ñ‚Ğ¾Ğº Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¾Ğ³Ğ¾ Ğ´Ğ½Ñ
WORKING_HOURS_END=22    # ĞšÑ–Ğ½ĞµÑ†ÑŒ Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¾Ğ³Ğ¾ Ğ´Ğ½Ñ
```

### Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ concurrency (ĞºÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ğ¿Ğ°Ñ€Ğ°Ğ»ĞµĞ»ÑŒĞ½Ğ¸Ñ… Ğ´Ğ·Ğ²Ñ–Ğ½ĞºÑ–Ğ²):
```env
# .env
MAX_CONCURRENT_CALLS=3  # ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ğ¾Ğ´Ğ½Ğ¾Ñ‡Ğ°ÑĞ½Ğ¸Ñ… Ğ´Ğ·Ğ²Ñ–Ğ½ĞºÑ–Ğ² Ğ½Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ñ–Ñ
```

**ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ¸:**
- `MAX_CONCURRENT_CALLS=5` - Ğ´Ğ»Ñ Ğ¿Ğ¾Ñ‚ÑƒĞ¶Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²ĞµÑ€Ğ°
- `MAX_CONCURRENT_CALLS=1` - Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ°Ğ±Ğ¾ ÑĞ»Ğ°Ğ±ĞºĞ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²ĞµÑ€Ğ°
- `MAX_CONCURRENT_CALLS=10` - Ğ´Ğ»Ñ Ğ²Ğ¸ÑĞ¾ĞºĞ¾Ğ³Ğ¾ Ğ½Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ

### Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ Ñ‚Ğ°Ğ¹Ğ¼Ğ·Ğ¾Ğ½Ñƒ:
```typescript
// src/utils/date.ts
export function getKyivTime(): Date {
  return new Date(new Date().toLocaleString('en-US', { 
    timeZone: 'Europe/Kiev' // â† Ğ·Ğ¼Ñ–Ğ½Ñ–Ñ‚ÑŒ Ñ‚ÑƒÑ‚
  }));
}
```

## ğŸ› Troubleshooting

### Ğ”Ğ·Ğ²Ñ–Ğ½ĞºĞ¸ Ğ½Ğµ Ğ²Ñ–Ğ´ĞºĞ»Ğ°Ğ´Ğ°ÑÑ‚ÑŒÑÑ:
1. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ `.env`: `USE_MOCK_CALLS=false`
2. ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ñ–Ñ‚ÑŒ ÑĞµÑ€Ğ²ĞµÑ€
3. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸: Ğ¼Ğ°Ñ” Ğ±ÑƒÑ‚Ğ¸ "â° ĞŸĞ¾Ğ·Ğ° Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¼ Ñ‡Ğ°ÑĞ¾Ğ¼"

### Ğ”Ğ·Ğ²Ñ–Ğ½ĞºĞ¸ Ğ½Ğµ Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑÑ‚ÑŒÑÑ Ğ²Ñ€Ğ°Ğ½Ñ†Ñ–:
1. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ Bull Queue settings: `lockDuration: 300000`
2. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ `attempts: 3` Ğ² defaultJobOptions
3. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Redis

### Ğ§Ğ°Ñ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¸Ğ¹:
1. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ Ñ‚Ğ°Ğ¹Ğ¼Ğ·Ğ¾Ğ½Ñƒ ÑĞµÑ€Ğ²ĞµÑ€Ğ°: `date`
2. ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ñ‚Ğµ `getKyivTime()` Ğ² Ğ»Ğ¾Ğ³Ğ°Ñ…
3. Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒĞ¹Ñ‚Ğµ `TZ=Europe/Kiev node src/index.ts`

## ğŸ“ ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ Ğ»Ğ¾Ğ³Ñ–Ğ²

**Ğ Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ:**
```
ğŸ“© Ğ”Ğ¾Ğ´Ğ°Ğ½Ğ¾ Ğ´Ğ·Ğ²Ñ–Ğ½Ğ¾Ğº Ğ² Ñ‡ĞµÑ€Ğ³Ñƒ (test-1): { phoneNumber: '380501111111' } | Job ID: test-1-123456
ğŸ“ Processing call job test-1-123456 (test-1)
ğŸ§ª Ğ’Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ”Ñ‚ÑŒÑÑ MOCK Ñ€ĞµĞ¶Ğ¸Ğ¼
âœ… Job test-1-123456 completed (test-1)
```

**ĞŸĞ¾Ğ·Ğ° Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¼ Ñ‡Ğ°ÑĞ¾Ğ¼:**
```
â° ĞŸĞ¾Ğ·Ğ° Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¼ Ñ‡Ğ°ÑĞ¾Ğ¼ (23:15)
ğŸ“… Ğ”Ğ·Ğ²Ñ–Ğ½Ğ¾Ğº Ğ²Ñ–Ğ´ĞºĞ»Ğ°Ğ´ĞµĞ½Ğ¾ Ğ´Ğ¾: 19.11.2025, 08:00:00
ğŸ“© Ğ’Ñ–Ğ´ĞºĞ»Ğ°Ğ´ĞµĞ½Ğ¾ Ğ´Ğ·Ğ²Ñ–Ğ½Ğ¾Ğº Ğ² Ñ‡ĞµÑ€Ğ³Ñƒ (test-1): { phoneNumber: '380501111111' } | Delay: 525 Ñ…Ğ²
```

## ğŸ¯ ĞÑ‡Ñ–ĞºÑƒĞ²Ğ°Ğ½Ñ– Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¸

| Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ñ–Ğ¹ | Active | Waiting | Delayed | Completed |
|----------|--------|---------|---------|-----------|
| Ğ Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ + MOCK | 3 | N-3 | 0 | Ğ—Ñ€Ğ¾ÑÑ‚Ğ°Ñ” |
| Ğ Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ñ‡Ğ°Ñ + REAL | 3 | N-3 | 0 | Ğ—Ñ€Ğ¾ÑÑ‚Ğ°Ñ” |
| ĞĞ• Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ + MOCK | 3 | N-3 | 0 | Ğ—Ñ€Ğ¾ÑÑ‚Ğ°Ñ” |
| ĞĞ• Ñ€Ğ¾Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ + REAL | 0 | 0 | N | 0 â†’ N Ğ¾ 8:00 |

